angular.module("swipeLi",[]),angular.module("swipeLi").provider("hammerRemote",function(){"use strict";var e=this;return this.globalOptions={},this.$get=["$q",function(n){var t,i,a={count:0},r={},o="__HAMMER_ID_";return r.globalOptions=e.globalOptions,r.getHammer=function(e){return a.hasOwnProperty(e)||t(e),a[e].deferred.promise},r.register=function(e,n){var r=new window.Hammer(e,n),s=o+a.count+"__";return a.count++,a.hasOwnProperty(s)||t(s),a[s].isResolved&&t(s),i(r,s),s},r.unregister=function(e){a.hasOwnProperty(e)&&delete a[e]},t=function(e){a[e]={deferred:n.defer(),isResolved:!1}},i=function(e,n){a[n].deferred.resolve(e),a[n].isResolved=!0},r}],this}),function(){for(var e=0,n=["ms","moz","webkit","o"],t=0;t<n.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[n[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n[t]+"CancelAnimationFrame"]||window[n[t]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),i=Math.max(0,16-(t-e)),a=window.setTimeout(function(){n(t+i)},i);return e=t+i,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),angular.module("swipeLi").directive("swipeLi",["hammerRemote","$timeout","$window",function(e,n,t){"use strict";return{restrict:"A",template:'<div class="swipe-li"><ul><li class="pane accept"><ng-include src="acceptContent"></ng-include></li><li class=""><ng-include src="mainContent"></ng-include></li><li class="pane reject"><ng-include src="rejectContent"></ng-include></div></li></li></ul></div>',link:function(i,a,r){function o(){d=s[0].offsetWidth,angular.forEach(l,function(e){angular.element(e).css({width:d+"px"})}),angular.element(c).css({width:d*u+"px"})}i.mainContent=i.$eval(r.mainContent),i.acceptContent=i.$eval(r.acceptContent),i.rejectContent=i.$eval(r.rejectContent),i.resetToContent=i.$eval(r.resetToContent),i.intent=i.$eval(r.intent),i.setToPaneIndex=i.$eval(r.setToPaneIndex),-1==[0,1,2].indexOf(i.setToPaneIndex)&&(i.setToPaneIndex=1),i.onComplete=function(e){n(function(){i.resetToContent&&i.showPane(1,!0),i.$apply(r[e])},300)};var s=a.find("div"),c=a.find("ul"),l=a.find("li"),d=0,u=3,m=0;i.init=function(){o(),i.showPane(i.setToPaneIndex,!1),angular.element(t).on("load resize orientationchange",function(){o()})},i.showPane=function(e,n){e=Math.max(0,Math.min(e,u-1)),m=e;var t=-(100/u*m);i.setContainerOffset(t,n)},i.setContainerOffset=function(e,n){if(c.removeClass("animate"),n&&c.addClass("animate"),Modernizr.csstransforms3d)c.css("transform","translate3d("+e+"%,0,0) scale3d(1,1,1)");else if(Modernizr.csstransforms)c.css("transform","translate("+e+"%,0)");else{var t=d*u/100*e;c.css("left",t+"px")}},i.handleHammer=function(e){if(e.gesture.preventDefault(),!i.$eval(r.disabled))switch(e.type){case"dragright":case"dragleft":var n=-(100/u)*m,t=100/d*e.gesture.deltaX/u;(0==m&&"right"==e.gesture.direction||m==u-1&&"left"==e.gesture.direction)&&(t*=.4),i.setContainerOffset(t+n);break;case"swipeleft":i.showPane(2,!0),i.onComplete("reject"),e.gesture.stopDetect();break;case"swiperight":i.showPane(0,!0),i.onComplete("accept"),e.gesture.stopDetect();break;case"release":!i.intent&&Math.abs(e.gesture.deltaX)<d?i.showPane(m,!0):Math.abs(e.gesture.deltaX)>d/2?"right"==e.gesture.direction?(i.showPane(0,!0),i.onComplete("accept")):(i.showPane(2,!0),i.onComplete("reject")):i.showPane(m,!0)}},i.id=e.register(s[0],{drag_lock_to_axis:!0}),e.getHammer(i.id).then(function(e){e.on("release dragleft dragright swipeleft swiperight",i.handleHammer),i.init()}),i.$on("$destroy",function(){e.unregister(i.id)})}}}]);